# 2025-11-03-15-15-50_확장성개선

## 요청 사항

embed_and_store.py의 확장성을 높이기 위한 코드 수정:

1. sabotage_rulebook.txt 외에 다른 게임도 추가할 수 있도록 코드 수정
2. embedding 대상이 되는 룰북은 /rulebooks/final 폴더 아래 {게임명}.rulebook.txt 형태로 저장
3. final/*.txt를 만들기 위한 최초의 pdf는 rulebooks/target-pdf 아래 /by-ocr, /by-text 폴더에 저장
4. pdf는 {게임명}.rulebook.pdf 형태로 제공, 1차 가공 결과물은 rulebooks/target-text 아래 {게임명}.rulebook_text.txt 형태로 저장
5. /tools/text-to-markdown-by-llm.py는 rulebook_text.txt를 이용해서 final 폴더에 최종 파일 생성
6. 실행할 때마다 target-text와 final 폴더를 비우고 새롭게 generating

## 수행 작업

### 1. 폴더 구조 생성
```bash
rulebooks/
├── target-pdf/
│   ├── by-ocr/
│   └── by-text/
├── target-text/
└── final/
```

### 2. process_rulebooks.py 생성
- PDF → 텍스트 → 최종 마크다운 전체 파이프라인 통합
- 실행 시 target-text, final 폴더 자동 초기화
- target-pdf 폴더의 모든 {게임명}.rulebook.pdf 자동 탐지
- OCR/일반 PDF 자동 구분 처리
- LLM으로 최종 마크다운 생성

### 3. embed_and_store.py 수정
- 단일 게임 하드코딩 → 다중 게임 자동 처리로 변경
- rulebooks/final/ 폴더의 모든 .rulebook.txt 파일 자동 탐지
- 각 게임별로 독립적인 ChromaDB 생성 (chroma_db/{게임명}/)
- main() 함수 추가로 전체 프로세스 자동화

### 4. README.md 작성
- 전체 파이프라인 설명
- 폴더 구조 및 사용 방법 문서화
- 새 게임 추가 가이드 제공

## 결과

- 새 게임 추가 시 PDF만 target-pdf에 넣고 2개 스크립트 실행하면 완료
- 확장 가능한 멀티 게임 룰북 임베딩 시스템 구축
- 매 실행마다 클린한 상태에서 재생성
